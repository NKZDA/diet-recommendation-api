<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Booming Diet ‚Äî ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>
  <style>
    :root { --pink:#e866a5; --border:#f5c1d8; }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(#fdfafb,#ffffff);font-family:system-ui,-apple-system,Segoe UI,Roboto;color:#111}
    a{color:var(--pink);text-decoration:none} a:hover{text-decoration:underline}
    .topbar{position:sticky;top:0;z-index:20;background:rgba(255,255,255,.7);backdrop-filter:saturate(1.4) blur(6px);border-bottom:1px solid #f3e1ea}
    .container{max-width:980px;margin:0 auto;padding:14px 20px}
    .back{border:1px solid #e5e7eb;border-radius:999px;padding:8px 16px;background:#fff;cursor:pointer}
    .brand{position:relative;display:flex;justify-content:center;align-items:center;height:40px}
    .brand span{font-weight:800;color:var(--pink)}
    h1{font-size:42px;margin:28px 0 8px}
    .card{background:#fbfbfb;border:1px solid var(--border);border-radius:18px;padding:24px}
    .bullets{margin:0 0 18px 0;padding-left:18px} .bullets li{margin:6px 0}
    label{display:block;font-weight:600;margin:12px 0 6px}
    input, textarea, select{width:100%;padding:12px 14px;border:1px solid var(--border);border-radius:12px;font-size:15px;background:#fff}
    textarea{min-height:90px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr;gap:14px}
    @media(min-width:720px){ .two{grid-template-columns:1fr 1fr} .three{grid-template-columns:1fr 1fr 1fr} }
    .muted{color:#6b7280;font-size:13px}
    .check{display:flex;gap:10px;align-items:flex-start;margin-top:8px}
    .btn{border:none;border-radius:14px;padding:12px 18px;font-weight:800;cursor:pointer}
    .btn-primary{background:var(--pink);color:#fff}
    .btn-primary:disabled{opacity:.6;cursor:not-allowed}
    .center{text-align:center}
    .alert{margin-top:14px;font-size:14px;padding:10px;border-radius:12px;display:none}
    .ok{background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}
    .err{background:#fff1f2;color:#9f1239;border:1px solid #fecdd3}
    .footer{color:#94a3b8;font-size:12px;margin:18px 0;text-align:center}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="container" style="display:flex;align-items:center;justify-content:space-between">
      <button class="back" onclick="history.back()">‡∏Å‡∏•‡∏±‡∏ö</button>
      <div class="brand">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 21s-6.5-3.9-9.1-7.1C1.6 12.1 2 8.8 4.5 7.3 6.4 6.2 8.7 6.8 10 8.4c1.3-1.6 3.6-2.2 5.5-1.1 2.5 1.5 2.9 4.8 1.6 6.6C18.5 17.1 12 21 12 21z" fill="#F59BB2"/>
          <path d="M18.8 4.5c-2.3-.4-4.3.6-5.6 2.1 1.7.1 3.6-.4 5-.9 1-.4 1.5-1.2.6-1.2z" fill="#8FD6C9"/>
        </svg>
        <span>Booming Diet</span>
      </div>
    </div>
  </div>

  <div class="container">
    <h1>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</h1>
    <div class="card">
      <ul class="bullets">
        <li>‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å Booming Diet</li>
        <li>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏ú‡∏ô‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì</li>
        <li>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡∏™‡∏∞‡∏î‡∏ß‡∏Å</li>
      </ul>

      <form id="regForm">
        <div class="row two">
          <div><label>‡∏ä‡∏∑‡πà‡∏≠*</label><input type="text" id="firstName" required /></div>
          <div><label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•*</label><input type="text" id="lastName" required /></div>
        </div>

        <div class="row two">
          <div><label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label><input type="email" id="email" /></div>
          <div><label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠*</label><input type="tel" id="phone" required /></div>
        </div>

        <div class="row"><div><label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label><textarea id="address"></textarea></div></div>

        <div class="row three">
          <div><label>‡∏ß‡∏±‡∏ô</label><select id="dobDay" required></select></div>
          <div><label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label><select id="dobMonth" required></select></div>
          <div><label>‡∏õ‡∏µ (‡∏Ñ.‡∏®.)</label><select id="dobYear" required></select></div>
        </div>

        <div class="check">
          <input type="checkbox" id="agree" required />
          <label for="agree" class="muted" style="font-weight:400">
            ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö <a href="#">‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a> ‡πÅ‡∏•‡∏∞ <a href="#">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a>
          </label>
        </div>

        <div class="check">
          <input type="checkbox" id="mkt" />
          <label for="mkt" class="muted" style="font-weight:400">‡∏Ç‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏û‡∏¥‡πÄ‡∏®‡∏©</label>
        </div>

        <div class="center" style="margin-top:16px">
          <button id="submitBtn" class="btn btn-primary" type="submit">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å Booming Diet</button>
          <div id="ok" class="alert ok">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ</div>
          <div id="err" class="alert err">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
          <div class="muted" style="margin-top:10px">
            ‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß? <a href="./login.html">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</a>
          </div>
        </div>
      </form>
    </div>

    <div class="footer">¬© <span id="year"></span> Booming Diet</div>
  </div>

  <script>
    const API_BASE = "http://localhost:5000";         // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á
    const REGISTER_URL = API_BASE + "/api/register";

    const daySel = document.getElementById("dobDay");
    const monthSel = document.getElementById("dobMonth");
    const yearSel = document.getElementById("dobYear");
    const now = new Date();
    daySel.innerHTML   = '<option value="">‡∏ß‡∏±‡∏ô</option>' + [...Array(31)].map((_,i)=>`<option>${i+1}</option>`).join("");
    const months = ["‡∏°.‡∏Ñ.","‡∏Å.‡∏û.","‡∏°‡∏µ.‡∏Ñ.","‡πÄ‡∏°.‡∏¢.","‡∏û.‡∏Ñ.","‡∏°‡∏¥.‡∏¢.","‡∏Å.‡∏Ñ.","‡∏™.‡∏Ñ.","‡∏Å.‡∏¢.","‡∏ï.‡∏Ñ.","‡∏û.‡∏¢.","‡∏ò.‡∏Ñ."];
    monthSel.innerHTML = '<option value="">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>' + months.map((m,i)=>`<option value="${i+1}">${m}</option>`).join("");
    const startY = now.getFullYear() - 100;
    yearSel.innerHTML  = '<option value="">‡∏õ‡∏µ</option>' + [...Array(101)].map((_,i)=>`<option>${startY+i}</option>`).join("");
    document.getElementById("year").textContent = now.getFullYear();

    const $ = s=>document.querySelector(s);
    const ok = $("#ok"), err = $("#err"), btn = $("#submitBtn");

    function show(el,text){ if(text) el.textContent=text; el.style.display="block"; setTimeout(()=>el.style.display="none",4500); }

    $("#regForm").addEventListener("submit", async (e)=>{
      e.preventDefault();
      const payload = {
        firstName: $("#firstName").value.trim(),
        lastName:  $("#lastName").value.trim(),
        email:     $("#email").value.trim() || null,
        phone:     $("#phone").value.trim(),
        address:   $("#address").value.trim() || null,
        dob:       { day: daySel.value, month: monthSel.value, year: yearSel.value },
        agree:     $("#agree").checked,
        marketingOptIn: $("#mkt").checked
      };
      if(!payload.firstName || !payload.lastName || !payload.phone || !payload.dob.day || !payload.dob.month || !payload.dob.year || !payload.agree){
        return show(err,"‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç");
      }
      btn.disabled = true;
      try{
        const res = await fetch(REGISTER_URL,{ method:"POST", headers:{ "Content-Type":"application/json" }, body: JSON.stringify(payload)});
        if(!res.ok) throw new Error(await res.text() || ("HTTP "+res.status));
        const data = await res.json().catch(()=>({}));
        if(data?.success){
          show(ok,"‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üéâ");
          setTimeout(()=>location.href="./login.html",1200); // ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ Login
        }else{
          throw new Error(data?.message || "‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
        }
      }catch(e2){ show(err,"‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: "+e2.message); }
      finally{ btn.disabled = false; }
    });
  </script>
</body>
</html>
